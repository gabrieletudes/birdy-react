(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{139:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(72),i=t.n(l),s=(t(79),t(6)),o=t(7),c=t(9),m=t(8),u=t(10),d=(t(81),t(142)),p=t(144),g=t(140),h=t(143),b=t(4),f=t.n(b),v={apiKey:"AIzaSyAHWcwh5U_EXXyICQAIwPof9za-p7d_pgA",authDomain:"birdy-2d83a.firebaseapp.com",databaseURL:"https://birdy-2d83a.firebaseio.com",projectId:"birdy-2d83a",storageBucket:"birdy-2d83a.appspot.com",messagingSenderId:"212095890669"},_=t(11),y=t(137),E=function(e){var a=e.label,t=e.type,n=e.name,l=e.value,i=e.onChange,s=e.ariaDescription,o=e.errormessage,c=e.defaultValue,m="label",u="label__input",d="label__text";return o&&(m+=" label--error",u+=" label__input--error",d+=" label__text--error"),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:m,htmlFor:n},r.a.createElement("input",{type:t,name:n,onChange:i,value:l,className:u,id:n,"aria-describedby":s,required:!0,defaultValue:c}),r.a.createElement("span",{className:d},a))),o&&r.a.createElement("span",{className:"label__error"},o))},N=t(16),w=function(e){var a=e.message,t=e.type,n=t?"pop-container__message pop-container__message--".concat(t):"pop-container__message";return r.a.createElement("div",{className:"pop-container"},r.a.createElement("div",{className:n},r.a.createElement("span",{className:"pop-container__message-close","aria-label":"close the popup"},r.a.createElement(N.a,{icon:"times",size:"2x"})),r.a.createElement("p",null,a)))},x=t(43),O=t.n(x),j=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={account:{useremail:"",password:""},message:{text:null,type:null}},t.handleSignin=function(e){e.preventDefault();var a=t.state.account,n=a.useremail,r=a.password,l=Object(_.a)({},t.state.message);f.a.auth().signInWithEmailAndPassword(n,r).then(function(e){l.text="welcome user",l.type="success",t.setState({message:l})}).catch(function(e){l.text=e.message,l.type="error",t.setState({message:l})})},t.handleLog=function(e){var a=e.currentTarget,n=Object(_.a)({},t.state.account);n[a.name]=a.value,t.setState({account:n})},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this.state,a=e.account,t=e.message;return r.a.createElement("div",{className:"login-wrapper"},r.a.createElement("div",{className:"big-logo-wrapper"},r.a.createElement("img",{src:O.a,alt:"Birdy Logo",width:"auto",className:"round-image__element logo"})),t.text&&r.a.createElement(w,{message:t.text,type:t.type}),r.a.createElement("form",{onSubmit:this.handleSignin,action:"",className:"login-form form"},r.a.createElement(E,{type:"text",name:"useremail",onChange:this.handleLog,label:"Entrez ici votre Email *",value:a.useremail,className:"form-control","aria-describedby":"User Email"}),r.a.createElement(E,{type:"password",name:"password",onChange:this.handleLog,label:"Entrez ici votre mot de passe *",value:a.password,className:"form-control","aria-describedby":"Mot de passe de l'utilisateur"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary h-margin-top--tiny h-margin-bottom--small"},"Me connecter"),r.a.createElement(y.a,{className:"btn btn-secondary--outlined",to:"/signup"},"Creer un compte")))}}]),a}(n.Component),k=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={account:{full_name:"",isn_id:"",useremail:"",password:""},errors:{full_name:"",isn_id:"",useremail:"",password:""}},t.handleSignup=function(e){e.preventDefault();var a=t.state.account,n=a.useremail,r=a.password;f.a.auth().createUserWithEmailAndPassword(n,r).then(function(e){t.createNewUser(e)}).catch(function(e){console.error(e)})},t.handleLog=function(e){var a=e.currentTarget,n=Object(_.a)({},t.state.account);n[a.name]=a.value,t.setState({account:n})},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"createNewUser",value:function(e){var a=this.state.account,t=a.full_name,n=a.isn_id,r=e.user,l=r.email,i=r.uid;f.a.database().ref("users/"+i).set({full_name:t,email:l,isn_id:n,userId:i})}},{key:"render",value:function(){var e=this.state.account;return r.a.createElement("div",{className:"login-wrapper"},r.a.createElement("div",{className:"big-logo-wrapper"},r.a.createElement("img",{src:O.a,alt:"Birdy Logo",width:"132",className:"round-image__element"})),r.a.createElement("form",{onSubmit:this.handleSignup,action:"",className:"login-form form"},r.a.createElement(E,{type:"text",name:"full_name",onChange:this.handleLog,label:"Entrez ici votre Nom et prenom *",value:e.full_name,className:"form-control","aria-describedby":"Prenom de l'utilisateur",errormessage:"Mot de passe est obligatoir"}),r.a.createElement(E,{type:"text",name:"isn_id",onChange:this.handleLog,label:"Entez ici votre ID du ISN *",value:e.isn_id,className:"form-control","aria-describedby":"Id du ISN de l'utilisateur"}),r.a.createElement(E,{type:"text",name:"useremail",onChange:this.handleLog,label:"Entrez ici votre Email *",value:e.useremail,className:"form-control","aria-describedby":"User Email"}),r.a.createElement(E,{type:"password",name:"password",onChange:this.handleLog,label:"Entrez ici votre mot de passe *",value:e.password,className:"form-control","aria-describedby":"Mot de passe de l'utilisateur"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary h-margin-top--tiny h-margin-bottom--small"},"Creer mon compte"),r.a.createElement(y.a,{className:"btn btn-secondary--outlined",to:"/"},"Se connecter")))}}]),a}(n.Component),C=t(19),S=t(5),A=t.n(S),M=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={showmessage:!1,capture_session:{started:!1,location:{lat:"",lng:""},method:"",uid:f.a.auth().currentUser.uid},newcapture:{age:"",fat:"",gender:"M",latin_name:"",reprise:"Non",ring_number:"",session_id:"",uid:f.a.auth().currentUser.uid,weight:"",wings_length:""},errors:{}},t.setPosition=function(){var e=Object(_.a)({},t.state.capture_session);navigator.geolocation.getCurrentPosition(function(a){e.location.lat=t.roundToTwo(a.coords.latitude),e.location.lng=t.roundToTwo(a.coords.longitude),t.setState({capture_session:e})})},t.roundToTwo=function(e){return+(Math.round(e+"e+2")+"e-2")},t.handleCaptureSession=function(e){var a=e.currentTarget,n=Object(_.a)({},t.state.errors),r=t.validateProperty(a);r?n[a.name]=r:delete n[a.name];var l=Object(_.a)({},t.state.capture_session);l[a.name]=a.value,t.setState({capture_session:l,errors:n})},t.handleStartCaptureSession=function(e){e.preventDefault();var a=t.state.capture_session,n=a.location,r=a.method,l=a.uid,i=Date.now(),s=f.a.database().ref("capture_sessions/"+i);s.set({location:n,method:r,uid:l}),s.once("value").then(function(e){var a=Object(_.a)({},t.state.newcapture),n=Object(_.a)({},t.state.capture_session);a.session_id=e.key,n.started=!0,t.setState({capture_session:n}),t.setState({newcapture:a})})},t.schema={age:A.a.string().max(8).trim().required().label("Age de l\u2019oiseau"),fat:A.a.number().less(999999).positive().required().label("Adiposit\xe9"),gender:A.a.any().valid(["M","F"]).required().label("Sexe de l\u2019oiseau"),latin_name:A.a.string().trim().required().label("Nom latin"),reprise:A.a.boolean().truthy("Oui").falsy("Non").required().label("La reprise"),ring_number:A.a.string().max(20).trim().required().label("Le num\xe9ro de bague"),session_id:A.a.string().trim().alphanum().required(),uid:A.a.string().alphanum().required(),weight:A.a.string().trim().max(10).required().label("Le poids de l\u2019oiseau"),wings_length:A.a.string().trim().max(10).required().label("Longueur alaire"),method:A.a.string().trim().max(20).required().label("La methode")},t.validate=function(){var e=A.a.validate(t.state.newcapture,t.schema,{abortEarly:!1,escapeHtml:!0}).error;if(!e)return null;var a={},n=!0,r=!1,l=void 0;try{for(var i,s=e.details[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var o=i.value;a[o.path[0]]=o.message}}catch(c){r=!0,l=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw l}}return a},t.validateProperty=function(e){var a=e.name,n=e.value,r=Object(C.a)({},a,n),l=Object(C.a)({},a,t.schema[a]),i=A.a.validate(r,l).error;return i?i.details[0].message:null},t.handleAdd=function(e){var a=e.currentTarget,n=Object(_.a)({},t.state.errors),r=t.validateProperty(a);r?n[a.name]=r:delete n[a.name];var l=Object(_.a)({},t.state.newcapture);l[a.name]=a.value,t.setState({newcapture:l,errors:n})},t.handleSubmit=function(e){e.preventDefault();var a=t.state.newcapture,n=a.age,r=a.fat,l=a.gender,i=a.latin_name,s=a.reprise,o=a.ring_number,c=a.session_id,m=a.uid,u=a.weight,d=a.wings_length;f.a.database().ref("single_captures").push({age:n,fat:r,gender:l,latin_name:i,reprise:s,ring_number:o,session_id:c,uid:m,weight:u,wings_length:d}).then(function(){var e=Object(_.a)({},t.state.newcapture);e.age="",e.fat="",e.gender="M",e.latin_name="",e.reprise="Non",e.ring_number="",e.weight="",e.wings_length="",t.setState({newcapture:e})})},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;f.a.database().ref("single_captures").on("value",function(a){e.setState({single_captures:a.val()})}),this.setPosition()}},{key:"startNewSession",value:function(){var e=this.state.capture_session,a=e.started,t=e.method,n=this.state.errors,l=this.state.newcapture,i=l.age,s=l.fat,o=l.latin_name,c=l.ring_number,m=l.weight,u=l.wings_length,d="btn btn-primary h-margin-top--tiny h-margin-bottom--small";d+=n.method?" btn-primary--disabled":"";var p="btn btn-primary h-margin-top--tiny h-margin-bottom--small";return p+=this.validate()?" btn-primary--disabled":"",!0!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:""},"Envie de commencer une nouvelle capture?"),r.a.createElement("form",{onSubmit:this.handleStartCaptureSession,action:"",className:"login-form form h-margin-top--big"},r.a.createElement(E,{type:"text",name:"method",onChange:this.handleCaptureSession,label:"Method de capture",value:t,className:"form-control h-margin-top--tiny","aria-describedby":"Method de capture",errormessage:n.method}),r.a.createElement("button",{disabled:n.method,type:"submit",className:d},"Commencer la capture"),r.a.createElement(y.a,{className:"btn btn-secondary--outlined",to:"/mescaptures"},"Mes captures"))):r.a.createElement("form",{onSubmit:this.handleSubmit,action:"",className:"login-form form"},r.a.createElement(E,{type:"text",name:"latin_name",onChange:this.handleAdd,label:"Nom latin",value:o,className:"form-control","aria-describedby":"Nom latin de l'oiseau",errormessage:n.latin_name}),r.a.createElement(E,{type:"text",name:"ring_number",onChange:this.handleAdd,label:"Num\xe9ro de la bague",value:c,className:"form-control","aria-describedby":"Num\xe9ro de la bague de l'oiseau",errormessage:n.ring_number}),r.a.createElement(E,{type:"text",name:"age",onChange:this.handleAdd,label:"Age de l'oiseau",value:i,className:"form-control","aria-describedby":"Age de l'oiseau",errormessage:n.age}),r.a.createElement("div",{className:"form-group form-group--radios text--small"},r.a.createElement("p",{className:"label__radios"},"S'agit il d'une reprise?"),r.a.createElement("div",{className:"radio-group"},r.a.createElement("label",{className:"h-margin-right--small label-radio",htmlFor:"oui"},r.a.createElement("input",{type:"radio",name:"reprise",onClick:this.handleAdd,value:"Oui",className:"label-radio__input h-hidden-visually",id:"oui","aria-describedby":"Il s\u2019agit d'une reprise"}),r.a.createElement("span",{className:"label-radio__decoration"}),"Oui"),r.a.createElement("label",{className:"label-radio",htmlFor:"non"},r.a.createElement("input",{type:"radio",name:"reprise",onClick:this.handleAdd,value:"Non",defaultChecked:!0,className:"label-radio__input h-hidden-visually",id:"non","aria-describedby":"Il s\u2019agit pas d'une reprise"}),r.a.createElement("span",{className:"label-radio__decoration"}),"Non")),n.reprise&&r.a.createElement("span",{className:"label__error"},n.reprise)),r.a.createElement("div",{className:"form-group form-group--radios text--small"},r.a.createElement("p",{className:"label__radios"},"Sexe de l'oiseau"),r.a.createElement("div",{className:"radio-group"},r.a.createElement("label",{className:"h-margin-right--small label-radio",htmlFor:"male"},r.a.createElement("input",{type:"radio",name:"gender",onClick:this.handleAdd,value:"M",defaultChecked:!0,className:"label-radio__input h-hidden-visually",id:"male","aria-describedby":"Sexe de l'oiseau"}),r.a.createElement("span",{className:"label-radio__decoration"}),"Masculin"),r.a.createElement("label",{className:"label-radio",htmlFor:"female"},r.a.createElement("input",{type:"radio",name:"gender",onClick:this.handleAdd,value:"F",className:"label-radio__input h-hidden-visually",id:"female","aria-describedby":"Sexe de l'oiseau"}),r.a.createElement("span",{className:"label-radio__decoration"}),"F\xe9minin")),n.gender&&r.a.createElement("span",{className:"label__error"},n.gender)),r.a.createElement(E,{type:"text",name:"fat",onChange:this.handleAdd,label:"Adiposit\xe9",value:s,className:"form-control","aria-describedby":"Adiposit\xe9 de l'oiseau",errormessage:n.fat}),r.a.createElement(E,{type:"text",name:"wings_length",onChange:this.handleAdd,label:"Longueur alaire",value:u,className:"form-control","aria-describedby":"Longueur alaire de l'oiseau",errormessage:n.wings_length}),r.a.createElement(E,{type:"text",name:"weight",onChange:this.handleAdd,label:"Poids de l'oiseau",value:m,className:"form-control","aria-describedby":"Poids de l'oiseau",errormessage:n.weight}),r.a.createElement("button",{disabled:this.validate(),type:"submit",className:p},"Valider ma capture"),r.a.createElement(y.a,{className:"btn btn-secondary--outlined",to:"/signup"},"Finir la session de bagage"))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.startNewSession(),";")}}]),a}(n.Component),L=t(141),F=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={encyclopedia:null},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;f.a.database().ref("encyclopedia").on("value",function(a){e.setState({encyclopedia:a.val()})})}},{key:"renderEncyclopedia",value:function(){var e=this.state.encyclopedia;if(null!==e){var a=Object.values(e);return r.a.createElement(r.a.Fragment,null,a.map(function(e,a){return r.a.createElement("div",{key:a},r.a.createElement("ul",{className:"list-data"},r.a.createElement("li",{className:"list-data__element list-data__element--no-margin h-full-width h-centered"},r.a.createElement(L.a,{className:"",to:"/encyclopedie/"+a,key:a},r.a.createElement("img",{src:e.picture,alt:e.common_name,width:"auto",height:"250"}))),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("h2",null,r.a.createElement(L.a,{className:"",to:"/encyclopedie/"+a,key:a},e.common_name))),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Nom Latin"),e.latin_name),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Famille"),e.family),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Envergure"),e.wingspan),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Habitat"),e.habitat),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Lieux de nidifications"),e.nesting_spots)))}))}return r.a.createElement("p",null,"No data yet")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Encyclopedie"),this.renderEncyclopedia())}}]),a}(n.Component),I=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={bird:null},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.birdId;f.a.database().ref("encyclopedia").orderByKey().equalTo(a).on("value",function(a){e.setState({bird:a.val()})})}},{key:"renderBird",value:function(){var e=this.state.bird;if(null!==e){var a=Object.values(e);return r.a.createElement(r.a.Fragment,null,a.map(function(e,a){return r.a.createElement("div",{key:a},r.a.createElement("ul",{className:"list-data"},r.a.createElement("li",{className:"list-data__element list-data__element--no-margin h-full-width h-centered"},r.a.createElement("img",{src:e.picture,alt:"",width:"250",height:"250"})),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("h1",null,e.common_name)),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("audio",{className:"custom-audio-small",preload:"metadata",controls:!0,src:e.song}," Your browser does not support the ",r.a.createElement("code",null,"audio")," element.")),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Nom Latin"),e.latin_name),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Famille"),e.family),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Type de vol"),e.flight_type),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Taille"),e.height),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Dur\xe9e de vie"),e.lifetime),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"lat"),e.distribution.lat,r.a.createElement("span",{className:"text-bold h-margin-left--small h-margin-right--tiny"},"lng"),e.distribution.lng),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Alimentation"),e.food),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Poids"),e.weight),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Envergure"),e.wingspan),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Habitat"),e.habitat),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Lieux de nidifications"),e.nesting_spots),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Description"),e.description)))}))}return r.a.createElement("p",null,"No data yet")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.renderBird())}}]),a}(n.Component),T=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={captures:null,uid:f.a.auth().currentUser.uid},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.state.uid;f.a.database().ref("single_captures").orderByChild("uid").equalTo(a).on("value",function(a){e.setState({captures:a.val()})})}},{key:"renderCaptures",value:function(){var e=this.state.captures;if(null!==e){var a=Object.keys(e);return r.a.createElement(r.a.Fragment,null,a.map(function(a,t){return r.a.createElement("div",{key:a},r.a.createElement("ul",{className:"list-data"},r.a.createElement("li",{className:"list-data__element"},r.a.createElement("h2",null,e[a].latin_name)),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"\xc2ge"),e[a].age),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Sex"),e[a].gender),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Reprise"),e[a].reprise),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Num\xe9ro de bague"),e[a].ring_number),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Poids"),e[a].weight),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Longueur alaire"),e[a].wings_length),r.a.createElement("li",{className:"list-data__element"},r.a.createElement(L.a,{className:"btn btn-primary h-margin-top--tiny h-margin-bottom--small",to:"/mescaptures/"+a,key:a},"Editer"))))}))}return r.a.createElement("p",null,"Vous n\u2019avez encore aucune capture")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Mes captures"),this.renderCaptures())}}]),a}(n.Component),P=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={capture:{key:"",age:"",fat:"",gender:"",latin_name:"",reprise:"",ring_number:"",session_id:"",weight:"",wings_length:""},captureId:null,errors:{},themessage:{show:!1,text:""}},t.schema={key:A.a.string(),age:A.a.string().max(8).trim().required().label("Age de l\u2019oiseau"),fat:A.a.number().less(999999).positive().required().label("Adiposit\xe9"),gender:A.a.any().valid(["M","F"]).required().label("Sexe de l\u2019oiseau"),latin_name:A.a.string().trim().required().label("Nom latin"),reprise:A.a.boolean().truthy("Oui").falsy("Non").required().label("La reprise"),ring_number:A.a.string().max(20).trim().required().label("Le num\xe9ro de bague"),session_id:A.a.string().trim().alphanum().required(),uid:A.a.string().alphanum().required(),weight:A.a.string().trim().max(10).required().label("Le poids de l\u2019oiseau"),wings_length:A.a.string().trim().max(10).required().label("Longueur alaire")},t.validate=function(){var e=A.a.validate(t.state.capture,t.schema,{abortEarly:!1,escapeHtml:!0}).error;if(!e)return null;var a={},n=!0,r=!1,l=void 0;try{for(var i,s=e.details[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var o=i.value;a[o.path[0]]=o.message}}catch(c){r=!0,l=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw l}}return a},t.validateProperty=function(e){var a=e.name,n=e.value,r=Object(C.a)({},a,n),l=Object(C.a)({},a,t.schema[a]),i=A.a.validate(r,l).error;return i?i.details[0].message:null},t.handleAdd=function(e){var a=e.currentTarget,n=Object(_.a)({},t.state.errors),r=t.validateProperty(a);r?n[a.name]=r:delete n[a.name];var l=Object(_.a)({},t.state.capture);l[a.name]=a.value,t.setState({capture:l,errors:n})},t.handleUpdate=function(e){e.preventDefault();var a=t.state.capture,n=a.age,r=a.fat,l=a.gender,i=a.latin_name,s=a.reprise,o=a.ring_number,c=a.session_id,m=a.uid,u=a.weight,d=a.wings_length,p="single_captures/"+t.state.captureId;f.a.database().ref(p).update({age:n,fat:r,gender:l,latin_name:i,reprise:s,ring_number:o,session_id:c,uid:m,weight:u,wings_length:d}).then(function(){t.setState({themessage:{show:!0,text:"La donn\xe9e a \xe9tait mise \xe0 jour, dans 5 seconds, vous allez \xeatre r\xe9dig\xe9 vers la page de vos captures."}}),setTimeout(function(){t.setState({themessage:{show:!1}}),t.props.history.push("/mescaptures")},5e3)})},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.captureId;f.a.database().ref("single_captures").orderByKey().equalTo(a).on("value",function(t){var n={};t.forEach(function(e){var a=e.val(),t=a.age,r=a.fat,l=a.gender,i=a.latin_name,s=a.reprise,o=a.ring_number,c=a.session_id,m=a.uid,u=a.weight,d=a.wings_length;n={key:e.key,age:t,fat:r,gender:l,latin_name:i,reprise:s,ring_number:o,session_id:c,uid:m,weight:u,wings_length:d}}),e.setState(function(e){return{captureId:a,capture:Object(_.a)({},e.capture,{key:n.key,age:n.age,fat:n.fat,gender:n.gender,latin_name:n.latin_name,reprise:n.reprise,ring_number:n.ring_number,session_id:n.session_id,uid:n.uid,weight:n.weight,wings_length:n.wings_length})}})})}},{key:"renderCapture",value:function(){var e=this.state,a=e.capture,t=e.errors,n=e.themessage,l=this.state.capture,i=l.age,s=l.fat,o=l.gender,c=l.latin_name,m=l.reprise,u=l.ring_number,d=l.weight,p=l.wings_length,g="btn btn-primary h-margin-top--tiny h-margin-bottom--small";return g+=this.validate()?" btn-primary--disabled":"",null!==a?r.a.createElement(r.a.Fragment,null,n.show&&r.a.createElement(w,{message:n.text}),r.a.createElement("form",{onSubmit:this.handleUpdate,action:"",className:"login-form form h-margin-top--tiny"},r.a.createElement(E,{type:"text",name:"latin_name",onChange:this.handleAdd,label:"Nom latin",value:c,className:"form-control","aria-describedby":"Nom latin de l'oiseau",errormessage:t.latin_name}),r.a.createElement(E,{type:"text",name:"ring_number",onChange:this.handleAdd,label:"Num\xe9ro de la bague",value:u,className:"form-control","aria-describedby":"Num\xe9ro de la bague de l'oiseau",errormessage:t.ring_number}),r.a.createElement(E,{type:"text",name:"age",onChange:this.handleAdd,label:"Age de l'oiseau",value:i,className:"form-control","aria-describedby":"Age de l'oiseau",errormessage:t.age}),r.a.createElement("div",{className:"form-group form-group--radios text--small"},r.a.createElement("p",{className:"label__radios"},"S'agit il d'une reprise?"),r.a.createElement("div",{className:"radio-group"},r.a.createElement("label",{className:"h-margin-right--small label-radio",htmlFor:"oui"},r.a.createElement("input",{type:"radio",name:"reprise",onChange:this.handleAdd,value:"Oui",checked:"Oui"===m,className:"label-radio__input h-hidden-visually",id:"oui","aria-describedby":"Il s\u2019agit d'une reprise"}),r.a.createElement("span",{className:"label-radio__decoration"}),"Oui"),r.a.createElement("label",{className:"label-radio",htmlFor:"non"},r.a.createElement("input",{type:"radio",name:"reprise",onChange:this.handleAdd,value:"Non",checked:"Non"===m,className:"label-radio__input h-hidden-visually",id:"non","aria-describedby":"Il s\u2019agit pas d'une reprise"}),r.a.createElement("span",{className:"label-radio__decoration"}),"Non")),t.reprise&&r.a.createElement("span",{className:"label__error"},t.reprise)),r.a.createElement("div",{className:"form-group form-group--radios text--small"},r.a.createElement("p",{className:"label__radios"},"Sexe de l'oiseau"),r.a.createElement("div",{className:"radio-group"},r.a.createElement("label",{className:"h-margin-right--small label-radio",htmlFor:"male"},r.a.createElement("input",{type:"radio",name:"gender",onChange:this.handleAdd,value:"M",checked:"M"===o,className:"label-radio__input h-hidden-visually",id:"male","aria-describedby":"Sexe de l'oiseau"}),r.a.createElement("span",{className:"label-radio__decoration"}),"Masculin"),r.a.createElement("label",{className:"label-radio",htmlFor:"female"},r.a.createElement("input",{type:"radio",name:"gender",onChange:this.handleAdd,value:"F",checked:"F"===o,className:"label-radio__input h-hidden-visually",id:"female","aria-describedby":"Sexe de l'oiseau"}),r.a.createElement("span",{className:"label-radio__decoration"}),"F\xe9minin")),t.gender&&r.a.createElement("span",{className:"label__error"},t.gender)),r.a.createElement(E,{type:"text",name:"fat",onChange:this.handleAdd,label:"Adiposit\xe9",value:s,className:"form-control","aria-describedby":"Adiposit\xe9 de l'oiseau",errormessage:t.fat}),r.a.createElement(E,{type:"text",name:"wings_length",onChange:this.handleAdd,label:"Longueur alaire",value:p,className:"form-control","aria-describedby":"Longueur alaire de l'oiseau",errormessage:t.wings_length}),r.a.createElement(E,{type:"text",name:"weight",onChange:this.handleAdd,label:"Poids de l'oiseau",value:d,className:"form-control","aria-describedby":"Poids de l'oiseau",errormessage:t.weight}),r.a.createElement("button",{disabled:this.validate(),type:"submit",className:g},"Enregistrer les modifications"),r.a.createElement(y.a,{className:"btn btn-secondary--outlined",to:"/mescaptures"},"Annuler l'edition"))):r.a.createElement("p",null,"No data yet")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:""},"Modifier la capture"),this.renderCapture())}}]),a}(n.Component),U=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={users:null,single_captures:[],uid:f.a.auth().currentUser.uid},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getUsersWithCaptures()}},{key:"getUsersWithCaptures",value:function(){var e=this,a=Object(_.a)({},this.state.users),t=f.a.database().ref("users"),n=f.a.database().ref("single_captures");t.on("child_added",function(t){var r=t.key;a[r]={information:"",capturesamount:null},a[r].information=t.val(),n.orderByChild("uid").equalTo(r).once("value",function(t){a[r].capturesamount=t.val()?Object.values(t.val()).length:0,e.setState({users:a})})})}},{key:"renderUsers",value:function(){var e=this.state.users;if(null!==e){var a=Object.values(e);return r.a.createElement(r.a.Fragment,null,a.map(function(e,a){return r.a.createElement("div",{key:a},r.a.createElement("ul",{className:"list-data"},r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Nom et Prenom"),e.information.full_name),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Isn"),e.information.isn_id),r.a.createElement("li",{className:"list-data__element"},r.a.createElement("span",{className:"text-bold h-margin-right--tiny"},"Nombre de captures"),e.capturesamount)))}))}return r.a.createElement("p",null,"No data yet")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Les utilisateurs"),this.renderUsers())}}]),a}(n.Component),q=function(){return r.a.createElement("div",{className:"loading-container"},r.a.createElement("span",{className:"loading-container__dove animate-pass","aria-label":"Fetching data"},r.a.createElement(N.a,{icon:"dove",size:"3x"})),r.a.createElement("p",null,"We are looking for some Birds..."))},z=t(73),D=t.n(z),B=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={currentuser:{uid:f.a.auth().currentUser.uid,lat:50.2,lng:6.52},zoom:15,capture_sessions:[],loading:!0},t.setUserPosition=function(){var e=Object(_.a)({},t.state.currentuser);navigator.geolocation.getCurrentPosition(function(a){e.lat=t.roundToTwo(a.coords.latitude),e.lng=t.roundToTwo(a.coords.longitude),t.setState({currentuser:e})},function(){console.error("There\u2019s no position shared")},{maximumAge:6e4,timeout:27e3})},t.roundToTwo=function(e){return+(Math.round(e+"e+2")+"e-2")},t.renderMap=function(){t.loadScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyAHWcwh5U_EXXyICQAIwPof9za-p7d_pgA&callback=initMap")},t.loadScript=function(e){var a=window.document.getElementsByTagName("script")[0],t=window.document.createElement("script");t.src=e,t.async=!0,t.defer=!0,a.parentNode.insertBefore(t,a)},t.getAllCaptures=function(){var e=Object(_.a)({},t.state.capture_sessions),a=f.a.database().ref("capture_sessions");f.a.database().ref("single_captures").on("child_added",function(n){var r=n.val();e[n.key]={location:null},a.orderByKey().equalTo(r.session_id).once("child_added",function(a){var t=a.val();e[n.key].location=t.location}).then(t.setState({capture_sessions:e}))}),setTimeout(function(){t.setState({loading:!1}),t.renderMap()},1e3)},t.initMap=function(){var e=t.state,a=e.capture_sessions,n=e.currentuser,r=Object.values(a),l=new window.google.maps.Map(document.getElementById("map"),{center:{lat:n.lat,lng:n.lng},zoom:8}),i=r.map(function(e){return new window.google.maps.Marker({position:{lat:e.location.lat,lng:e.location.lng},map:l})});new D.a(l,i,{imagePath:"/map-images/m"})},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){window.initMap=this.initMap,this.getAllCaptures(),this.setUserPosition()}},{key:"componentWillUnmount",value:function(){this.removeGoogleMapAPI()}},{key:"removeGoogleMapAPI",value:function(){var e=window.document.getElementsByTagName("script")[0];e.parentNode.removeChild(e),window.google={}}},{key:"render",value:function(){return this.state.loading?r.a.createElement(q,null):r.a.createElement("div",{className:"birdy-map",id:"map"})}}]),a}(n.Component),W=function(e){function a(){return Object(s.a)(this,a),Object(c.a)(this,Object(m.a)(a).apply(this,arguments))}return Object(u.a)(a,e),Object(o.a)(a,[{key:"signOutUser",value:function(){f.a.auth().signOut()}},{key:"render",value:function(){return r.a.createElement("header",{className:"header"},r.a.createElement("h1",{className:"header__title"},"Birdy"),r.a.createElement("button",{onClick:this.signOutUser,className:"btn color--beige h-padding--none"},r.a.createElement(N.a,{icon:"sign-out-alt",size:"2x"})))}}]),a}(n.Component),H=function(e){function a(){return Object(s.a)(this,a),Object(c.a)(this,Object(m.a)(a).apply(this,arguments))}return Object(u.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("nav",{className:"app-nav"},r.a.createElement(L.a,{exact:!0,to:"/",className:"app-nav__link",activeClassName:"app-nav__link--selected"},r.a.createElement(N.a,{icon:"hand-holding",size:"2x"}),"Capturer"),r.a.createElement(L.a,{to:"/encyclopedie",className:"app-nav__link",activeClassName:"app-nav__link--selected"},r.a.createElement(N.a,{icon:"feather-alt",size:"2x"}),"Encyclopedie"),r.a.createElement(L.a,{to:"/sites-de-baguage",className:"app-nav__link",activeClassName:"app-nav__link--selected"},r.a.createElement(N.a,{icon:"map",size:"2x"}),"Sites"),r.a.createElement(L.a,{to:"/utilisateurs",className:"app-nav__link",activeClassName:"app-nav__link--selected"},r.a.createElement(N.a,{icon:"users",size:"2x"}),"Utilisateurs"))}}]),a}(n.Component),R=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(c.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(r)))).state={user:null},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){f.a.initializeApp(v),this.authListener()}},{key:"authListener",value:function(){var e=this;f.a.auth().onAuthStateChanged(function(a){a?(e.setState({user:a}),localStorage.setItem("user",a.uid)):(e.setState({user:null}),localStorage.removeItem("user"))})}},{key:"render",value:function(){return null===this.state.user?r.a.createElement(d.a,null,r.a.createElement(p.a,null,r.a.createElement(g.a,{path:"/",exact:!0,component:j}),r.a.createElement(g.a,{path:"/signup",component:k}),r.a.createElement(h.a,{to:"/"}))):r.a.createElement(d.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(W,null),r.a.createElement("main",{className:"app-main"},r.a.createElement(p.a,{location:this.props.location},r.a.createElement(g.a,{exact:!0,path:"/",component:M}),r.a.createElement(g.a,{exact:!0,path:"/sites-de-baguage",component:B}),r.a.createElement(g.a,{exact:!0,path:"/encyclopedie",component:F}),r.a.createElement(g.a,{path:"/encyclopedie/:birdId",component:I}),r.a.createElement(g.a,{exact:!0,path:"/mescaptures",component:T}),r.a.createElement(g.a,{path:"/mescaptures/:captureId",component:P}),r.a.createElement(g.a,{path:"/utilisateurs",component:U}),r.a.createElement(h.a,{to:"/"}))),r.a.createElement(H,null)))}}]),a}(n.Component),K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function V(e,a){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var X=t(37),G=t(21);X.b.add(G.a,G.b,G.g,G.d,G.e,G.c,G.f),i.a.render(r.a.createElement(R,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/birdy-react",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var a="".concat("/birdy-react","/service-worker.js");K?(function(e,a){fetch(e).then(function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):V(e,a)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(a,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):V(a,e)})}}()},43:function(e,a,t){e.exports=t.p+"static/media/logo-birdy-text.2596802d.svg"},74:function(e,a,t){e.exports=t(139)},79:function(e,a,t){},81:function(e,a,t){}},[[74,2,1]]]);
//# sourceMappingURL=main.14ea3749.chunk.js.map